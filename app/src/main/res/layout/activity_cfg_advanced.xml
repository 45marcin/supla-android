<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
	      xmlns:app="http://schemas.android.com/apk/res-auto"
	      xmlns:tools="http://schemas.android.com/tools">

  <data>
    <import type="android.view.View" />
    <import type="org.supla.android.cfg.TemperatureUnit" />
    <import type="org.supla.android.cfg.ChannelHeight" />
    <import type="android.R" />
    <variable
        name="viewModel"
        type="org.supla.android.cfg.CfgViewModel" />
  </data>

  <RelativeLayout
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:background="@color/activity_bg"
      android:clickable="true"
      android:focusableInTouchMode="true"
      android:paddingLeft="@dimen/activity_horizontal_margin"
      android:paddingTop="@dimen/activity_vertical_margin"
      android:paddingRight="@dimen/activity_horizontal_margin"
      android:paddingBottom="@dimen/activity_vertical_margin"
      tools:context="org.supla.android.CfgActivity">

    

    <co.ceryle.segmentedbutton.SegmentedButtonGroup
	      android:id="@+id/authType"
	      android:layout_width="match_parent"
	      android:layout_height="wrap_content"
	      android:layout_below="@id/cfg_cb_advanced"
	      android:layout_centerHorizontal="true"
        android:layout_marginTop="@dimen/form_label_spacing"
        android:layout_marginRight="0dp"
        android:layout_marginLeft="0dp"
        app:sbg_animateSelector="fastOutSlowIn"
        app:sbg_animateSelectorDuration="500"
        app:sbg_selectorColor="#ffffff"
        app:sbg_backgroundColor="?attr/switcherBackgroundColor"
        app:sbg_selectorBackgroundDrawable="@drawable/segment_group_selector"
        app:sbg_radius="6dp">
      <co.ceryle.segmentedbutton.SegmentedButton
          android:layout_width="0dp"
          android:layout_weight="1"
          android:layout_margin="4dp"
          app:sb_textColor="#000000"
          android:layout_height="@dimen/segmented_button_height"
          app:sb_text="@string/cfg_label_email_auth" />
      <co.ceryle.segmentedbutton.SegmentedButton
          android:layout_width="0dp"
          app:sb_textColor="#000000"
          android:layout_margin="4dp"
          android:layout_weight="1"
          android:layout_height="@dimen/segmented_button_height"
          app:sb_text="@string/cfg_label_access_id_auth" />

    </co.ceryle.segmentedbutton.SegmentedButtonGroup>

		<FrameLayout
			  android:id="@+id/authFormWrapper"
	      android:layout_below="@id/authType"
	      android:layout_centerHorizontal="true"
			  android:layout_width="match_parent"
			  android:layout_height="wrap_content">

      <androidx.constraintlayout.widget.ConstraintLayout
          android:id="@+id/emailAuthForm"
          android:layout_width="match_parent"
          android:layout_height="wrap_content"
          app:visibility="@{viewModel.cfgData.authByEmail ? View.VISIBLE : View.GONE}">
			  <TextView
            style="@style/FormLabel"
					  android:id="@+id/cfg_label_email"
					  android:layout_width="wrap_content"
					  android:layout_height="wrap_content"
					  app:layout_constraintTop_toTopOf="parent"
					  app:layout_constraintStart_toStartOf="parent"
					  app:layout_constraintLeft_toLeftOf="parent"
					  android:layout_marginLeft="2dp"
					  android:layout_marginTop="@dimen/form_label_spacing"
					  android:text="@string/email"
					  android:textAppearance="?android:attr/textAppearanceSmall"
					  android:textColor="@android:color/black"
					  android:textSize="9sp" />
        <EditText
            android:id="@+id/cfg_email"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="@drawable/rounded_edittext"
            android:layout_marginTop="@dimen/form_label_dist"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintTop_toBottomOf="@id/cfg_label_email"
					  app:layout_constraintRight_toRightOf="parent"
					  android:inputType="textEmailAddress"
					  android:text="@={viewModel.cfgData.email}"
					  android:onTextChanged="@{viewModel::onEmailChange}"
					  android:padding="5dp"
					  android:textSize="14sp" />

			  <TextView
            style="@style/FormLabel"
					  android:id="@+id/cfg_label_svr_address_email"
					  android:layout_width="wrap_content"
					  android:layout_height="wrap_content"
					  app:layout_constraintTop_toBottomOf="@id/cfg_email"
					  app:layout_constraintStart_toStartOf="@id/edServerAddrEmail"
					  app:layout_constraintLeft_toLeftOf="@id/edServerAddrEmail"
					  android:layout_marginLeft="2dp"
					  android:layout_marginTop="@dimen/form_label_spacing"
					  android:text="@string/server_address"
					  android:textAppearance="?android:attr/textAppearanceSmall"
					  android:textColor="@android:color/black"
					  android:textSize="9sp" />

			  <EditText
					  android:id="@+id/edServerAddrEmail"
					  android:layout_width="0dp"
					  android:layout_height="wrap_content"
            android:background="@drawable/rounded_edittext"
					  app:layout_constraintTop_toBottomOf="@id/cfg_label_svr_address_email"
					  app:layout_constraintLeft_toLeftOf="@id/cfg_email"
					  app:layout_constraintRight_toLeftOf="@id/edServerAddrAutoEmail"
            android:enabled="@{!viewModel.serverAutoDiscovery}"
            android:layout_marginTop="@dimen/form_label_dist"
            android:inputType="textUri"
					  android:padding="5dp"
					  android:textSize="14sp"
            android:text="@={viewModel.cfgData.serverAddr}"
					  android:layout_marginRight="25dp" />

				<CheckBox
					  android:id="@+id/edServerAddrAutoEmail"
					  android:layout_width="wrap_content"
					  android:layout_height="wrap_content"
            android:textAllCaps="false"
            android:button="@null"
            android:drawableRight="?android:attr/listChoiceIndicatorMultiple"
					  app:layout_constrainedWidth="true"
					  app:layout_constraintRight_toRightOf="parent"
					  app:layout_constraintBaseline_toBaselineOf="@id/edServerAddrEmail"
					  android:text="@string/cfg_checkbox_server_auto"
					  android:buttonTint="@color/channel_btn"
            android:checked="@{viewModel.serverAutoDiscovery}"
            android:onClick="@{() -> viewModel.toggleServerAutoDiscovery()}"
					  android:textSize="@dimen/default_text_size" />

        
      </androidx.constraintlayout.widget.ConstraintLayout>
		  <RelativeLayout
				  android:id="@+id/cfg_accessIdAuthForm"
				  android:layout_width="match_parent"
				  android:layout_height="wrap_content"
				  android:layout_alignParentTop="true"
				  android:layout_alignParentLeft="true"
          android:layout_alignParentStart="true"
				  android:visibility="@{viewModel.cfgData.authByEmail ? View.GONE : View.VISIBLE}">

			  <TextView
            style="@style/FormLabel"
					  android:id="@+id/cfg_label_svr_address"
					  android:layout_width="wrap_content"
					  android:layout_height="wrap_content"
					  android:layout_alignParentTop="true"
					  android:layout_alignStart="@id/edServerAddr"
					  android:layout_alignLeft="@id/edServerAddr"
					  android:layout_marginLeft="2dp"
            android:layout_marginTop="@dimen/form_label_spacing"
					  android:layout_marginBottom="@dimen/form_label_dist"
					  android:text="@string/server_address"
					  android:textAppearance="?android:attr/textAppearanceSmall"
					  android:textColor="@android:color/black"
					  android:textSize="9sp" />
			  <EditText
					  android:id="@+id/edServerAddr"
					  android:layout_width="match_parent"
					  android:layout_height="wrap_content"
					  android:layout_below="@id/cfg_label_svr_address"
					  android:layout_alignParentStart="true"
					  android:layout_alignParentLeft="true"
					  android:inputType="textUri"
            android:background="@drawable/rounded_edittext"
					  android:padding="5dp"
					  android:text="@={viewModel.cfgData.serverAddr}"
					  android:textSize="14sp" />
			  <TextView
            style="@style/FormLabel"
					  android:id="@+id/cfg_label_access_id"
					  android:layout_width="wrap_content"
					  android:layout_height="wrap_content"
					  android:layout_below="@id/edServerAddr"
					  android:layout_alignStart="@id/edAccessID"
					  android:layout_alignLeft="@id/edAccessID"
					  android:layout_marginLeft="2dp"
					  android:layout_marginTop="@dimen/form_label_spacing"
					  android:layout_marginBottom="@dimen/form_label_dist"
					  android:text="@string/access_id"
					  android:textAppearance="?android:attr/textAppearanceSmall"
					  android:textColor="@android:color/black"
					  android:textSize="9sp" />

			  <EditText
					  android:id="@+id/edAccessID"
					  android:layout_width="match_parent"
					  android:layout_height="wrap_content"
					  android:layout_below="@+id/cfg_label_access_id"
					  android:layout_alignParentStart="true"
					  android:layout_alignParentLeft="true"
            android:background="@drawable/rounded_edittext"
					  android:padding="5dp"
					  android:text="@={viewModel.accessID}"
					  android:textSize="14sp" />

			  <TextView
            style="@style/FormLabel"
					  android:id="@+id/cfg_label_access_pwd"
					  android:layout_width="wrap_content"
					  android:layout_height="wrap_content"
					  android:layout_below="@id/edAccessID"
					  android:layout_alignLeft="@id/edAccessIDpwd"
					  android:layout_marginLeft="2dp"
					  android:layout_marginTop="@dimen/form_label_spacing"
					  android:layout_marginBottom="@dimen/form_label_dist"
					  android:text="@string/password"
					  android:textAppearance="?android:attr/textAppearanceSmall"
					  android:textColor="@android:color/black"
					  android:textSize="9sp" />

			  <EditText
					  android:id="@+id/edAccessIDpwd"
					  android:layout_width="match_parent"
					  android:layout_height="wrap_content"
					  android:layout_below="@id/cfg_label_access_pwd"
					  android:layout_centerVertical="true"
					  android:inputType="textPassword"
            android:background="@drawable/rounded_edittext"
					  android:padding="5dp"
					  android:text="@={viewModel.cfgData.accessIDpwd}"
					  android:textSize="14sp" />
        
        <TextView
            android:id="@+id/addDeviceWarning"
					  android:layout_width="match_parent"
					  android:layout_height="wrap_content"
					  android:layout_below="@id/edAccessIDpwd"
					  android:layout_marginTop="@dimen/form_label_spacing"
					  android:layout_centerHorizontal="true"
            android:gravity="center"
            android:textSize="14sp"
            android:text="@string/add_device_warning" />
		  </RelativeLayout>
    </FrameLayout>

    <org.supla.android.ui.StandaloneRoundedButton
        android:id="@+id/cfg_save_advanced"
        style="@style/StandaloneRoundedGreenButton"
        android:layout_width="match_parent"
        android:layout_height="@dimen/standalone_button_height"
        android:layout_below="@id/authFormWrapper"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="40dp"
        android:enabled="@{viewModel.saveEnabled}"
        android:onClick="@{() -> viewModel.onSaveConfig()}"
        android:text="@string/confirm_button_text"
        />
  </RelativeLayout>


</layout>
